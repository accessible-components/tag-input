
/**
 * @accessible-components/tag-input - Simple and accessible component for creating tags.
 * @version v0.1.0
 * @link https://github.com/accessible-components/tag-input
 * @copyright 2020 Sergei Kriger, https://sergeikriger.com/
 * @license MIT
 */
function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t){var e=13,a=27,i=37,s=39,n=9,l=46;function r(t,e){if(!t)throw new Error("Element not found.");for(var a in e=e||{},this.settings={tags:[],prefix:"tag-input",name:"tag-input",placeholder:"Add tags",label:"Tags",ariaTag:"Tag {{TAG}}.",ariaEditTag:"Edit tag.",ariaDeleteTag:"Delete tag {{TAG}}.",ariaTagAdded:"Tag {{TAG}} added.",ariaTagUpdated:"Tag updated to {{TAG}}.",ariaTagDeleted:"Tag {{TAG}} deleted.",ariaTagSelected:"Tag {{TAG}} selected. Press enter to edit, delete to delete.",ariaNoTagsSelected:"No tags selected.",ariaInputLabel:"{{TAGS}} tags. Use left and right arrow keys to navigate, enter or tab to create, delete to delete tags."},e)e.hasOwnProperty(a)&&(this.settings[a]=e[a]);this.tags=[],this.id=A(),this.value="",d.call(this,t)}function d(t){var e=this;t.classList.add("".concat(this.settings.prefix,"-container"));var a=document.createElement("label");a.classList.add("".concat(this.settings.prefix,"-label")),a.htmlFor="".concat(this.settings.prefix,"-").concat(this.id),a.textContent=this.settings.label,this.settings.hiddenLabel&&p(a),t.appendChild(a);var i=document.createElement("span");p(i),a.appendChild(i);var s=document.createElement("div");s.classList.add(this.settings.prefix),this.tagInput=s,this.settings.disabled&&s.classList.add("".concat(this.settings.prefix,"--disabled")),t.appendChild(s);var n=document.createElement("input"),l=o.bind(this),r=c.bind(this);n.setAttribute("type","text"),n.setAttribute("placeholder",this.settings.placeholder),n.classList.add("".concat(this.settings.prefix,"__input")),n.id="".concat(this.settings.prefix,"-").concat(this.id),this.inputEl=n,this.value=this.inputEl.value,this.settings.disabled&&n.setAttribute("disabled",!0),n.addEventListener("focus",(function(){document.addEventListener("keyup",l),document.addEventListener("keydown",r)})),n.addEventListener("blur",(function(){document.removeEventListener("keyup",l),document.removeEventListener("keydown",r),_.call(e)})),this.tagInput.appendChild(n);var d=document.createElement("input");d.setAttribute("type","hidden"),d.setAttribute("name",this.settings.name),this._inputEl=d,this.tagInput.appendChild(d);var h=document.createElement("span");p(h),h.id="".concat(this.settings.prefix,"-live-region-").concat(A()),t.appendChild(h),this.settings.tags.forEach((function(t){e.addTag(t,!0),b.call(e)}))}function c(t){switch(t.keyCode){case n:case e:t.target.value&&this._selected&&t.preventDefault();break;case i:if(this.tags.length&&!t.target.value){var l=this.tags.indexOf(this._selected),r=this.tags[this.tags.length-1],d=this.tags[l-1];d?(x.call(this,d),m.call(this,this.settings.ariaTagSelected.replace("{{TAG}}",d))):0!==l&&(x.call(this,r),m.call(this,this.settings.ariaTagSelected.replace("{{TAG}}",r)))}break;case s:if(this.tags.length&&!t.target.value){var c=this.tags.indexOf(this._selected),o=this.tags[c+1];o&&c>=0?(x.call(this,o),m.call(this,this.settings.ariaTagSelected.replace("{{TAG}}",o))):c===this.tags.length-1&&(_.call(this),m.call(this,this.settings.ariaNoTagsSelected))}break;case a:this._selected&&(_.call(this),m.call(this,this.settings.ariaNoTagsSelected))}}function o(t){switch(t.target.value&&_.call(this),t.keyCode){case e:t.target.value?(this.addTag(t.target.value),b.call(this),m.call(this,this.settings.ariaTagAdded.replace("{{TAG}}",t.target.value)),this.inputEl.value=""):this._selected&&T.call(this,this._selected);break;case n:t.target.value&&(this.addTag(t.target.value),b.call(this),m.call(this,this.settings.ariaTagAdded.replace("{{TAG}}",t.target.value)),this.inputEl.value="");break;case l:if(!this.value)if(this._selected)this.removeTag(this._selected),b.call(this),m.call(this,this.settings.ariaTagDeleted.replace("{{TAG}}",this._selected)),_.call(this);else if(this.tags.length){var a=this.tags[this.tags.length-1];this.removeTag(a),b.call(this),m.call(this,this.settings.ariaTagDeleted.replace("{{TAG}}",a)),_.call(this)}}this.value=this.inputEl.value}function h(t){switch(t.keyCode){case e:t.preventDefault()}}function u(t){var i=t.target.parentNode,s=i.dataset.tagValue;switch(t.keyCode){case a:this.inputEl.focus();break;case e:var n=f(t.target.value);if(!n)return this.removeTag(i.dataset.tagValue),this.inputEl.focus(),void m.call(this,this.settings.ariaTagDeleted.replace("{{TAG}}",i.dataset.tagValue));this.tags=this.tags.map((function(t){return t===s?n:t})),v.call(this),m.call(this,this.settings.ariaTagUpdated.replace("{{TAG}}",n)),i.dataset.tagValue=n,this.inputEl.focus(),this.settings.onTagUpdate&&this.settings.onTagUpdate(s,n,this.tags)}}function g(t){var e=t.target.parentNode,a=e.querySelector(".".concat(this.settings.prefix,"__text")),i=e.querySelector(".".concat(this.settings.prefix,"__edit"));a.textContent=t.target.value,i.style.width="".concat(a.getBoundingClientRect().width,"px")}function p(t){t.style.clip="1px, 1px, 1px, 1px",t.style.height="1px",t.style.width="1px",t.style.overflow="hidden",t.style.position="absolute",t.style.whiteSpace="nowrap"}function f(t){return t.trim()}function v(){this._inputEl.value=JSON.stringify(this.tags)}function m(t){var e=this.tagInput.parentNode,a=e.querySelector('[id^="'.concat(this.settings.prefix,'-live-region-"]'));a&&e.removeChild(a);var i=document.createElement("span");i.id="".concat(this.settings.prefix,"-live-region-").concat(A()),i.setAttribute("aria-live","assertive"),i.setAttribute("role","alert"),p(i),e.appendChild(i),i.textContent=t}function b(){this.tagInput.parentNode.querySelector(".".concat(this.settings.prefix,"-label span")).textContent=", ".concat(this.settings.ariaInputLabel.replace("{{TAGS}}",this.tags.length))}function T(t){var e=y.call(this,t),a=e.querySelector(".".concat(this.settings.prefix,"__text")),i=e.querySelector(".".concat(this.settings.prefix,"__edit")),s=e.querySelector(".".concat(this.settings.prefix,"__edit-label"));e.classList.add("".concat(this.settings.prefix,"__tag--editable")),i.style.width="".concat(a.getBoundingClientRect().width,"px"),i.removeAttribute("aria-hidden"),s.removeAttribute("aria-hidden"),i.focus()}function y(t){return this.tagInput.querySelector('[data-tag-value="'.concat(t,'"]'))}function x(t){this._selected!==t&&_.call(this);var e=y.call(this,t);e&&(e.classList.add("".concat(this.settings.prefix,"__tag--selected")),this._selected=t)}function _(){var t=this.tagInput.querySelector(".".concat(this.settings.prefix,"__tag--selected"));t&&t.classList.remove("".concat(this.settings.prefix,"__tag--selected")),this._selected=null}function A(){return Math.floor(1e4*Math.random())}r.prototype.addTag=function(t,e){var a=this,i=this.settings,s="string"==typeof t?f(t):null;if(s&&-1===this.tags.indexOf(s)){var n=document.createElement("div");n.classList.add("".concat(i.prefix,"__tag")),n.setAttribute("aria-label",i.ariaTag.replace("{{TAG}}",s)),n.dataset.tagValue=s;var l=document.createElement("span");l.classList.add("".concat(i.prefix,"__text")),l.textContent=s,l.setAttribute("aria-hidden",!0),n.appendChild(l),i.disabled||l.addEventListener("dblclick",(function(t){T.call(a,t.target.parentNode.dataset.tagValue)}));var r=document.createElement("label"),d="tag-id-".concat(A());r.htmlFor=d,r.textContent=i.ariaEditTag,r.classList.add("".concat(i.prefix,"__edit-label")),r.setAttribute("aria-hidden",!0),p(r),n.appendChild(r);var c=document.createElement("input"),o=u.bind(this),b=h.bind(this),y=g.bind(this);c.classList.add("".concat(i.prefix,"__edit")),c.setAttribute("tabindex",-1),c.setAttribute("type","text"),c.setAttribute("aria-hidden",!0),c.value=s,c.id=d,n.appendChild(c),c.addEventListener("focus",(function(){document.addEventListener("keyup",o),document.addEventListener("keydown",b),document.addEventListener("input",y)})),c.addEventListener("blur",(function(t){document.removeEventListener("keyup",o),document.removeEventListener("keydown",b),document.removeEventListener("input",y),n.classList.remove("".concat(i.prefix,"__tag--editable")),c.setAttribute("aria-hidden",!0),r.setAttribute("aria-hidden",!0),t.target.value!==n.dataset.tagValue&&(l.textContent=n.dataset.tagValue,c.value=n.dataset.tagValue),_.call(a)}));var x=this.inputEl;if(!i.disabled){var E=document.createElement("button"),L=this.removeTag.bind(this),S=m.bind(this);E.classList.add("".concat(i.prefix,"__remove")),E.setAttribute("tabindex",-1),E.setAttribute("type","button"),E.setAttribute("aria-label",i.ariaDeleteTag.replace("{{TAG}}",s)),E.innerHTML='\n    <svg viewBox="0 0 100 100">\n      <line x1="10" y1="10" x2="90" y2="90" stroke-width="20" stroke-linecap="round" />\n      <line x1="10" y1="90" x2="90" y2="10" stroke-width="20" stroke-linecap="round" />\n    </svg>\n  ',n.appendChild(E),E.addEventListener("click",(function(){var t=this.parentNode.dataset.tagValue;L(t),S(i.ariaTagDeleted.replace("{{TAG}}",t)),x.focus()})),E.querySelector("svg").classList.add("".concat(i.prefix,"__remove-icon"))}this.tagInput.insertBefore(n,x),this.tags.push(s),v.call(this),!e&&i.onTagAdd&&i.onTagAdd(s,this.tags)}},r.prototype.removeTag=function(t){var e=y.call(this,t);e&&(e.remove(),this.tags=this.tags.filter((function(e){return e!==t})),this.settings.onTagRemove&&this.settings.onTagRemove(t,this.tags))},r.prototype.getTags=function(){return this.tags},"undefined"!=typeof module&&void 0!==module.exports?module.exports=r:"function"==typeof define&&define.amd?define("TagInput",[],(function(){return r})):"object"===_typeof(t)&&(t.TagInput=r)}(this);